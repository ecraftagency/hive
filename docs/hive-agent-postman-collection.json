{
  "info": {
    "name": "Hive Agent API Collection",
    "description": "Collection đầy đủ cho tất cả API endpoints của Hive Agent service",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "version": "1.0.0"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080",
      "type": "string",
      "description": "Base URL của Agent service"
    },
    {
      "key": "player_id",
      "value": "player123",
      "type": "string",
      "description": "ID người chơi để test"
    },
    {
      "key": "ticket_id",
      "value": "",
      "type": "string",
      "description": "ID ticket được tạo từ submit ticket"
    },
    {
      "key": "room_id",
      "value": "",
      "type": "string",
      "description": "ID phòng được tạo từ matchmaking"
    }
  ],
  "auth": {
    "type": "noauth"
  },
  "item": [
    {
      "name": "1. Submit Ticket (Gửi Ticket)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"player_id\": \"{{player_id}}\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/tickets",
          "host": ["{{base_url}}"],
          "path": ["tickets"]
        },
        "description": "Tạo ticket mới cho người chơi để tham gia phòng game"
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "// Lưu ticket_id vào biến collection để sử dụng cho các request khác",
              "if (pm.response.code === 200) {",
              "    const response = pm.response.json();",
              "    if (response.ticket_id) {",
              "        pm.collectionVariables.set('ticket_id', response.ticket_id);",
              "        console.log('Ticket ID đã được lưu:', response.ticket_id);",
              "    }",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "2. Get Ticket Status (Lấy Trạng Thái Ticket)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/tickets/{{ticket_id}}",
          "host": ["{{base_url}}"],
          "path": ["tickets", "{{ticket_id}}"]
        },
        "description": "Lấy trạng thái hiện tại của ticket"
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "// Lưu room_id vào biến collection nếu ticket được matched",
              "if (pm.response.code === 200) {",
              "    const response = pm.response.json();",
              "    if (response.status === 'MATCHED' && response.room_id) {",
              "        pm.collectionVariables.set('room_id', response.room_id);",
              "        console.log('Room ID đã được lưu:', response.room_id);",
              "    }",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "3. Cancel Ticket (Hủy Ticket)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{}"
        },
        "url": {
          "raw": "{{base_url}}/tickets/{{ticket_id}}/cancel",
          "host": ["{{base_url}}"],
          "path": ["tickets", "{{ticket_id}}", "cancel"]
        },
        "description": "Hủy ticket đang mở và xóa khỏi hàng đợi"
      },
      "response": []
    },
    {
      "name": "4. Get Room Information (Lấy Thông Tin Phòng)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/rooms/{{room_id}}",
          "host": ["{{base_url}}"],
          "path": ["rooms", "{{room_id}}"]
        },
        "description": "Lấy thông tin chi tiết về một phòng cụ thể"
      },
      "response": []
    },
    {
      "name": "5. Admin Overview (Tổng Quan Admin)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/admin/overview",
          "host": ["{{base_url}}"],
          "path": ["admin", "overview"]
        },
        "description": "Lấy tổng quan toàn diện về tất cả trạng thái hệ thống (chỉ admin)"
      },
      "response": []
    },
    {
      "name": "6. Web UI (Giao Diện Web)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/",
          "host": ["{{base_url}}"],
          "path": [""]
        },
        "description": "Phục vụ giao diện web dashboard của Agent"
      },
      "response": []
    }
  ]
}
